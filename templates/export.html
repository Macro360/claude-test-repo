{% extends "base.html" %}

{% block title %}Export Schedule - Auto Scheduler{% endblock %}

{% block content %}
<div class="export-page">
    <h2>Export Schedule</h2>
    <p>Download your schedule in various formats for external use.</p>

    <div class="export-options">
        <div class="export-card">
            <h3>JSON Export</h3>
            <p>Complete schedule data in JSON format for programmatic use.</p>
            <a href="{{ url_for('export_json') }}" class="btn btn-primary" download>Download JSON</a>
        </div>

        <div class="export-card">
            <h3>CSV Exports</h3>
            <p>Export data as CSV files for use in spreadsheet applications.</p>
            <div class="button-group">
                <a href="{{ url_for('export_csv', export_type='schedule') }}" class="btn btn-info" download>Complete Schedule</a>
                <a href="{{ url_for('export_csv', export_type='employees') }}" class="btn btn-info" download>Employees Only</a>
                <a href="{{ url_for('export_csv', export_type='tasks') }}" class="btn btn-info" download>Tasks Only</a>
            </div>
        </div>

        <div class="export-card">
            <h3>Text Reports</h3>
            <p>Human-readable reports for printing or sharing.</p>
            <div class="button-group">
                <a href="{{ url_for('export_report', report_type='full') }}" class="btn btn-success" download>Full Report</a>
                <a href="{{ url_for('export_report', report_type='summary') }}" class="btn btn-success" download>Summary Only</a>
                <a href="{{ url_for('export_report', report_type='employees') }}" class="btn btn-success" download>Employee Report</a>
                <a href="{{ url_for('export_report', report_type='tasks') }}" class="btn btn-success" download>Task Report</a>
            </div>
        </div>
    </div>

    <div class="preview-section">
        <h3>Schedule Preview</h3>
        <div class="stats-preview">
            <p><strong>Total Employees:</strong> {{ schedule.employees|length }}</p>
            <p><strong>Total Tasks:</strong> {{ schedule.tasks|length }}</p>
            <p><strong>Assigned Tasks:</strong> {{ schedule.get_assigned_tasks()|length }}</p>
            <p><strong>Completion Rate:</strong> {{ "%.1f"|format(schedule.get_completion_rate()) }}%</p>
        </div>
    </div>

    <div class="action-buttons">
        <a href="{{ url_for('view_schedule') }}" class="btn btn-secondary">Back to Schedule</a>
        <a href="{{ url_for('index') }}" class="btn btn-secondary">Back to Dashboard</a>
    </div>
</div>
{% endblock %}
